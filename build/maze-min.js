!function(){function e(e){let t=[],o=e=>Math.floor((e-1)/2),y=e=>2*e+1,x=e=>2*(e+1),n=function(e,o){let y=t[e];t[e]=t[o],t[o]=y},r=(e=e||{}).compare||((e,t)=>e<t);return{get:e=>t[e]||t,push:function(){return Array.from(arguments).forEach(e=>{let y=t.push(e)-1;for(;y>0&&r(t[y],t[o(y)]);)n(y,o(y)),y=o(y)}),t.length},empty:()=>!t.length,pop:function(){if(!this.empty()){let e=0,o=t[e];if(1===t.length)t.pop();else for(t[e]=t.pop();t[y(e)]&&r(t[y(e)],t[e])||t[x(e)]&&r(t[x(e)],t[e]);)t[x(e)]&&r(t[x(e)],t[y(e)])?(n(e,x(e)),e=x(e)):(n(e,y(e)),e=y(e));return o}}}}function t(){let e=[];return{get:t=>e[t]||e,empty:()=>!e.length,push:t=>e.push(t),pop:()=>e.shift()}}function o(){let e=[];return{get:t=>e[t]||e,empty:()=>!e.length,push:t=>e.push(t),pop:()=>e.pop()}}let y,x,n=e=>document.querySelector(e),r=n("canvas"),f=r.getContext("2d"),l=!1,i=n("#sizetxt"),h=n("#algotxt"),s=n("#speedtxt"),u=n("#resetbtn"),a=n("#pausebtn");window.maze||(window.maze=new function(){let n,u,p,w,c,d,v,m,g,M,z,E,k,I={st:0},b=[],L={compare:(e,t)=>e.w<t.w},S=()=>Math.floor(10*Math.random()),P=e=>e.x>0&&e.y>0&&e.x<u-1&&e.y<p-1,F=function(e,t){(t=t||{}).width=t.width||n,f.fillStyle=t.color,f.fillRect(n*e.x+(n-t.width)/2,n*e.y+(n-t.width)/2,t.width,t.width)},N=function(e){let t={x:e.x,y:e.y,fx:e.fx||e.x,fy:e.fy||e.y};if(!v[t.x][t.y]){v[t.x][t.y]=v[t.fx][t.fy]=1;let e,o=[];for(t.x-2>0&&o.push({w:S(),x:t.x-2,y:t.y,fx:t.x-1,fy:t.y}),t.y-2>0&&o.push({w:S(),x:t.x,y:t.y-2,fx:t.x,fy:t.y-1}),t.x+2<u-1&&o.push({w:S(),x:t.x+2,y:t.y,fx:t.x+1,fy:t.y}),t.y+2<p-1&&o.push({w:S(),x:t.x,y:t.y+2,fx:t.x,fy:t.y+1}),o.sort((e,t)=>e.w-t.w);e=o.pop();)w.get().filter(({x:t,y:o})=>t===e.x&&o===e.y).length<1&&!v[e.x][e.y]&&w.push({w:S(),x:e.x,y:e.y,fx:e.fx,fy:e.fy})}},R=function(e){f.clearRect(0,0,window.innerWidth,window.innerHeight),w.get().forEach(({x:e,y:t,fx:o,fy:y})=>{F({x:e,y:t},{color:"red"}),F({x:o,y:y},{color:"red"})});for(let e=u-1;e>=0;e--)for(let t=p-1;t>=0;t--)v[e][t]&&F({x:e,y:t},{color:"white"});b&&b.forEach(({fx:e,fy:t})=>{F({x:e,y:t},{color:"orange"})}),e&&F(e,{color:"blue",width:n-Math.floor(n/5)})},V=function(e,t,o){let y=[];for(let x=e-1;x>=0;x--){y[x]=[];for(let e=t-1;e>=0;e--)y[x][e]=o||0}return y},W=function(e){let t=r.getBoundingClientRect();return{x:Math.floor((e.clientX-t.left)/n),y:Math.floor((e.clientY-t.top)/n)}},C=function(t){m=V(u,p),M=V(u,p,u*p+5);let o,y=new e(L);for(y.push({x:t.x,y:t.y,w:0});o=y.pop();)P(o)&&v[o.x][o.y]&&!m[o.x][o.y]&&(m[o.x][o.y]=1,M[o.x][o.y]=Math.min(M[o.x][o.y],o.w),y.push({x:o.x+1,y:o.y,w:o.w+1}),y.push({x:o.x-1,y:o.y,w:o.w+1}),y.push({x:o.x,y:o.y+1,w:o.w+1}),y.push({x:o.x,y:o.y-1,w:o.w+1}))},H=function(t){let o,y=new e(L),x=[],n=V(u,p);for(y.push({x:t.x,y:t.y,w:M[t.x][t.y]});(o=y.pop())&&(n[o.x][o.y]||(n[o.x][o.y]=1,y.push({x:o.x+1,y:o.y,w:M[o.x+1][o.y]}),y.push({x:o.x-1,y:o.y,w:M[o.x-1][o.y]}),y.push({x:o.x,y:o.y+1,w:M[o.x][o.y+1]}),y.push({x:o.x,y:o.y-1,w:M[o.x][o.y-1]}),x.push({x:o.x,y:o.y}),o.w)););return x},q=function(e,t){t=t||{};let o,y=Math.floor(n/2),x=t.path||H(e);for(f.lineWidth=t.width||Math.ceil(n/5),f.strokeStyle=t.color||"red",f.beginPath();o=x.pop();)f.lineTo(o.x*n+y,o.y*n+y);f.stroke()},A=function(e){let t=W(e);P(t)&&(t.x!==c||t.y!==d)&&v[t.x][t.y]&&(2===I.st&&clearInterval(y),E=H(t),y=setInterval(I.moveNode,x))},B=function(e){let t=W(e);z&&z.x===t.x&&z.y===t.y||(R({x:c,y:d}),P(t)&&(t.x!==c||t.y!==d)&&v[t.x][t.y]?(q(t),F(t,{color:"red",width:n-Math.floor(n/5)}),k=t):k=void 0,z=t)};return I.moveNode=function(){let e;if(!l)if(E&&(e=E.pop())){c=e.x,d=e.y,C({x:c,y:d}),R({x:c,y:d});let t=E.slice();t.push({x:c,y:d}),q(k,{path:t,color:"green",width:Math.ceil(n/5)+2}),!k||k.x===c&&k.y===d||(q(k),F(k,{color:"red",width:n-Math.floor(n/5)}))}else I.stop()},I.floodFillStep=function(){let e;l||(g&&(e=g.pop())?(function(e){let t={x:e.x,y:e.y};if(v[t.x][t.y]&&!m[t.x][t.y]){m[t.x][t.y]=1;let e,o=[];for(t.x-2>0&&o.push({x:t.x-2,y:t.y}),t.y-2>0&&o.push({x:t.x,y:t.y-2}),t.x+2<u-1&&o.push({x:t.x+2,y:t.y}),t.y+2<p-1&&o.push({x:t.x,y:t.y+2});e=o.shift();)g.filter(({x:t,y:o})=>t===e.x&&o===e.y).length<1&&g.push(e);if(v[t.x-1][t.y]+v[t.x][t.y-1]+v[t.x+1][t.y]+v[t.x][t.y+1]===1){let e,o=[];for(o.push({w:S(),x:t.x-2,y:t.y,fx:t.x-1,fy:t.y}),o.push({w:S(),x:t.x+2,y:t.y,fx:t.x+1,fy:t.y}),o.push({w:S(),x:t.x,y:t.y-2,fx:t.x,fy:t.y-1}),o.push({w:S(),x:t.x,y:t.y+2,fx:t.x,fy:t.y+1}),o.sort((e,t)=>e&&t&&e.w-t.w);e=o.shift();)if(e.x>0&&e.y>0&&e.x<u-1&&e.y<p-1&&!v[e.fx][e.fy]){v[e.fx][e.fy]=1,b.push({x:t.x,y:t.y,fx:e.fx,fy:e.fy});break}}}}(e),R(e)):(I.stop().st++,C({x:c,y:d}),R({x:c,y:d}),r.addEventListener("mousemove",B,!1),r.addEventListener("mousedown",A,!1)))},I.renderView=function(){let e;l||(w&&(e=w.pop())?(N(e),R(e)):(I.stop().st++,m=V(u,p),(g=[]).push({x:c,y:d}),y=setInterval(I.floodFillStep,x)))},I.start=function(){return r.width=window.innerWidth,r.height=window.innerHeight-40,n=i.value,u=Math.floor(r.width/n),p=Math.floor(r.height/n),x=s.value||1,l=!1,a.value="Pause",w="0"===h.value?new t:"1"===h.value?new o:new e(L),c=2*Math.floor(Math.random()*(u-2)/2)+1,d=2*Math.floor(Math.random()*(p-2)/2)+1,v=V(u,p),b=[],I.st=0,r.removeEventListener("mousemove",B),r.removeEventListener("mousedown",A),N({x:c,y:d}),y=setInterval(I.renderView,x),I},I.stop=(()=>(clearInterval(y),I)),I.start(),I}),u.addEventListener("click",function(){maze.stop().start()}),window.onresize=function(){u.click()},a.addEventListener("click",function(){l=!l,a.value="Pause"===a.value?"Play":"Pause"}),s.addEventListener("change",function(){switch(x=this.value,maze.stop(),maze.st){case 0:y=setInterval(maze.renderView,x);break;case 1:y=setInterval(maze.floodFillStep,x);break;case 2:y=setInterval(maze.moveNode,x)}})}();