!function(){function e(e){var t=[],o=e=>Math.floor((e-1)/2),r=e=>2*e+1,f=e=>2*(e+1),a=function(e,n){var o=t[e];t[e]=t[n],t[n]=o},y=(e=e||{}).compare||((e,t)=>e<t);return{get:e=>void 0==e?t:t[e],push:function(){return Array.from(arguments).forEach(e=>{for(n=t.push(e)-1;n>0&&y(t[n],t[o(n)]);)a(n,o(n)),n=o(n)}),t.length},empty:()=>0==t.length,pop:function(){if(!this.empty()){var e=0,n=t[e];if(1==t.length)t.pop();else for(t[e]=t.pop();t[r(e)]&&y(t[r(e)],t[e])||t[f(e)]&&y(t[f(e)],t[e]);)t[f(e)]&&y(t[f(e)],t[r(e)])?(a(e,f(e)),e=f(e)):(a(e,r(e)),e=r(e));return n}}}}var t,o,r=e=>document.getElementById(e),f=r("canvas"),a=f.getContext("2d"),y=!1,i=r("sizetxt"),x=r("algotxt"),h=r("speedtxt"),l=r("resetbtn"),s=r("pausebtn");window.maze||(window.maze=new function(){var n,r,l,u,p,c,v,w,d,m,g,M,I,E={st:0},z=[],k={compare:(e,t)=>e.w<t.w},b=()=>Math.floor(10*Math.random()),L=function(e,t,o){var r=(o=o||{}).width||n;a.fillStyle=o.color,a.fillRect(n*e+(n-r)/2,n*t+(n-r)/2,r,r)},P=function(e,t,n,o){if(n=n||e,o=o||t,0==v[e][t]){v[e][t]=v[n][o]=1;var f,a=[];for(e-2>0&&a.push({w:b(),x:e-2,y:t,fx:e-1,fy:t}),t-2>0&&a.push({w:b(),x:e,y:t-2,fx:e,fy:t-1}),e+2<r-1&&a.push({w:b(),x:e+2,y:t,fx:e+1,fy:t}),t+2<l-1&&a.push({w:b(),x:e,y:t+2,fx:e,fy:t+1}),a.sort((e,t)=>e.w<t.w);f=a.pop();)u.get().filter(({x:e,y:t})=>e==f.x&&t==f.y).length<1&&0==v[f.x][f.y]&&u.push({w:b(),x:f.x,y:f.y,fx:f.fx,fy:f.fy})}},N=function(e){a.clearRect(0,0,window.innerWidth,window.innerHeight),u.get().forEach(({x:e,y:t,fx:n,fy:o})=>{L(e,t,{color:"red"}),L(n,o,{color:"red"})});for(var t=r-1;t>=0;t--)for(var o=l-1;o>=0;o--)1==v[t][o]&&L(t,o,{color:"white"});z&&z.forEach(({fx:e,fy:t})=>{L(e,t,{color:"orange"})}),e&&L(e.x,e.y,{color:"blue",width:n-Math.floor(n/5)})},R=function(e,t,n){for(var o=[],r=e-1;r>=0;r--){o[r]=[];for(var f=t-1;f>=0;f--)o[r][f]=n||0}return o},V=function(e){var t=f.getBoundingClientRect();return{x:Math.floor((e.clientX-t.left)/n),y:Math.floor((e.clientY-t.top)/n)}},W=function(t){w=R(r,l),m=R(r,l,r*l+5);var n,o=new e(k);for(o.push({x:t.x,y:t.y,w:0});n=o.pop();)n.x>0&&n.y>0&&n.x<r-1&&n.y<l-1&&1==v[n.x][n.y]&&0==w[n.x][n.y]&&(w[n.x][n.y]=1,m[n.x][n.y]=Math.min(m[n.x][n.y],n.w),o.push({x:n.x+1,y:n.y,w:n.w+1}),o.push({x:n.x-1,y:n.y,w:n.w+1}),o.push({x:n.x,y:n.y+1,w:n.w+1}),o.push({x:n.x,y:n.y-1,w:n.w+1}))},B=function(t){var n,o=new e(k),f=[],a=R(r,l);for(o.push({x:t.x,y:t.y,w:m[t.x][t.y]});(n=o.pop())&&(0!=a[n.x][n.y]||(a[n.x][n.y]=1,o.push({x:n.x+1,y:n.y,w:m[n.x+1][n.y]}),o.push({x:n.x-1,y:n.y,w:m[n.x-1][n.y]}),o.push({x:n.x,y:n.y+1,w:m[n.x][n.y+1]}),o.push({x:n.x,y:n.y-1,w:m[n.x][n.y-1]}),f.push({x:n.x,y:n.y}),n.w)););return f},C=function(e,t){t=t||{};var o,r=Math.floor(n/2),f=t.path||B(e);for(a.lineWidth=t.width||Math.ceil(n/5),a.strokeStyle=t.color||"red",a.beginPath();o=f.pop();)a.lineTo(o.x*n+r,o.y*n+r);a.stroke()},H=function(e){var n=V(e);n.x>0&&n.y>0&&n.x<r-1&&n.y<l-1&&(n.x!=p||n.y!=c)&&1==v[n.x][n.y]&&(2==E.st&&clearInterval(t),M=B(n),t=setInterval(E.moveNode,o))},S=function(e){var t=V(e);g&&g.x==t.x&&g.y==t.y||(N({x:p,y:c}),t.x>0&&t.y>0&&t.x<r-1&&t.y<l-1&&(t.x!=p||t.y!=c)&&1==v[t.x][t.y]?(C(t),L(t.x,t.y,{color:"red",width:n-Math.floor(n/5)}),I=t):I=void 0,g=t)};return E.moveNode=function(){var e;if(!y)if(M&&(e=M.pop())){p=e.x,c=e.y,W({x:p,y:c}),N({x:p,y:c});var t=M.slice();t.push({x:p,y:c}),C(I,{path:t,color:"green",width:Math.ceil(n/5)+2}),!I||I.x==p&&I.y==c||(C(I),L(I.x,I.y,{color:"red",width:n-Math.floor(n/5)}))}else E.stop()},E.floodfillstep=function(){var e;y||(d&&(e=d.pop())?(function(e,t){if(1==v[e][t]&&0==w[e][t]){w[e][t]=1;var n,o=[];for(e-2>0&&o.push({x:e-2,y:t}),t-2>0&&o.push({x:e,y:t-2}),e+2<r-1&&o.push({x:e+2,y:t}),t+2<l-1&&o.push({x:e,y:t+2});n=o.shift();)d.filter(({x:e,y:t})=>e==n.x&&t==n.y).length<1&&d.push(n);if(v[e-1][t]+v[e][t-1]+v[e+1][t]+v[e][t+1]==1){var f,a=[];for(a.push({w:b(),x:e-2,y:t,fx:e-1,fy:t,d:"h"}),a.push({w:b(),x:e+2,y:t,fx:e+1,fy:t,d:"h"}),a.push({w:b(),x:e,y:t-2,fx:e,fy:t-1,d:"v"}),a.push({w:b(),x:e,y:t+2,fx:e,fy:t+1,d:"v"}),a.sort((e,t)=>e.w<t.w);f=a.shift();)if(f.x>0&&f.y>0&&f.x<r-1&&f.y<l-1&&0==v[f.fx][f.fy]){v[f.fx][f.fy]=1,z.push({x:e,y:t,fx:f.fx,fy:f.fy});break}}}}(e.x,e.y),N(e)):(clearInterval(t),E.st=2,W({x:p,y:c}),N({x:p,y:c}),f.addEventListener("mousemove",S,!1),f.addEventListener("mousedown",H,!1)))},E.renderView=function(){if(!y)if(u&&!u.empty()){var e=u.pop();P(e.x,e.y,e.fx,e.fy),N(e)}else clearInterval(t),E.st=1,w=R(r,l),(d=[]).push({x:p,y:c}),t=setInterval(E.floodfillstep,o)},E.start=function(){f.width=window.innerWidth,f.height=window.innerHeight-40,n=i.value,r=Math.floor(f.width/n),l=Math.floor(f.height/n),o=h.value||1,y=!1,s.value="Pause",u=0==x.value?new function(){var e=[];return{get:t=>void 0==t?e:e[t],empty:()=>0==e.length,push:t=>e.push(t),pop:()=>e.shift()}}:1==x.value?new function(){var e=[];return{get:t=>void 0==t?e:e[t],empty:()=>0==e.length,push:t=>e.push(t),pop:()=>e.pop()}}:new e(k),p=2*Math.floor(Math.random()*(r-2)/2)+1,c=2*Math.floor(Math.random()*(l-2)/2)+1,v=R(r,l),z=[],E.st=0,f.removeEventListener("mousemove",S),f.removeEventListener("mousedown",H),P(p,c),t=setInterval(E.renderView,o)},E.stop=function(){clearInterval(t)},E.start(),E}),l.addEventListener("click",function(){clearInterval(t),maze.start()}),window.onresize=function(){l.click()},s.addEventListener("click",function(){y=!y,s.value="Pause"==s.value?"Play":"Pause"}),h.addEventListener("change",function(){switch(o=this.value,clearInterval(t),maze.st){case 0:t=setInterval(maze.renderView,o);break;case 1:t=setInterval(maze.floodfillstep,o);break;case 2:t=setInterval(maze.moveNode,o)}})}();