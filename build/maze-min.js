!function(){function e(e){let t=[],o=e=>Math.floor((e-1)/2),y=e=>2*e+1,x=e=>2*(e+1),n=function(e,o){let y=t[e];t[e]=t[o],t[o]=y},r=(e=e||{}).compare||((e,t)=>e<t);return{get:e=>t[e]||t,push:function(){return Array.from(arguments).forEach(e=>{let y=t.push(e)-1;for(;y>0&&r(t[y],t[o(y)]);)n(y,o(y)),y=o(y)}),t.length},empty:()=>!t.length,pop:function(){if(!this.empty()){let e=0,o=t[e];if(1===t.length)t.pop();else for(t[e]=t.pop();t[y(e)]&&r(t[y(e)],t[e])||t[x(e)]&&r(t[x(e)],t[e]);)t[x(e)]&&r(t[x(e)],t[y(e)])?(n(e,x(e)),e=x(e)):(n(e,y(e)),e=y(e));return o}}}}let t,o,y=e=>document.querySelector(e),x=y("canvas"),n=x.getContext("2d"),r=!1,f=y("#sizetxt"),l=y("#algotxt"),i=y("#speedtxt"),h=y("#resetbtn"),s=y("#pausebtn");window.maze||(window.maze=new function(){let y,h,u,a,p,w,c,d,v,m,g,M,z,E={st:0},k=[],I={compare:(e,t)=>e.w<t.w},b=()=>Math.floor(10*Math.random()),L=e=>e.x>0&&e.y>0&&e.x<h-1&&e.y<u-1,S=function(e,t){(t=t||{}).width=t.width||y,n.fillStyle=t.color,n.fillRect(y*e.x+(y-t.width)/2,y*e.y+(y-t.width)/2,t.width,t.width)},P=function(e){let t={x:e.x,y:e.y,fx:e.fx||e.x,fy:e.fy||e.y};if(!c[t.x][t.y]){c[t.x][t.y]=c[t.fx][t.fy]=1;let e,o=[];for(t.x-2>0&&o.push({w:b(),x:t.x-2,y:t.y,fx:t.x-1,fy:t.y}),t.y-2>0&&o.push({w:b(),x:t.x,y:t.y-2,fx:t.x,fy:t.y-1}),t.x+2<h-1&&o.push({w:b(),x:t.x+2,y:t.y,fx:t.x+1,fy:t.y}),t.y+2<u-1&&o.push({w:b(),x:t.x,y:t.y+2,fx:t.x,fy:t.y+1}),o.sort((e,t)=>e&&t&&e.w<t.w);e=o.pop();)a.get().filter(({x:t,y:o})=>t===e.x&&o===e.y).length<1&&!c[e.x][e.y]&&a.push({w:b(),x:e.x,y:e.y,fx:e.fx,fy:e.fy})}},F=function(e){n.clearRect(0,0,window.innerWidth,window.innerHeight),a.get().forEach(({x:e,y:t,fx:o,fy:y})=>{S({x:e,y:t},{color:"red"}),S({x:o,y:y},{color:"red"})});for(let e=h-1;e>=0;e--)for(let t=u-1;t>=0;t--)c[e][t]&&S({x:e,y:t},{color:"white"});k&&k.forEach(({fx:e,fy:t})=>{S({x:e,y:t},{color:"orange"})}),e&&S(e,{color:"blue",width:y-Math.floor(y/5)})},N=function(e,t,o){let y=[];for(let x=e-1;x>=0;x--){y[x]=[];for(let e=t-1;e>=0;e--)y[x][e]=o||0}return y},R=function(e){let t=x.getBoundingClientRect();return{x:Math.floor((e.clientX-t.left)/y),y:Math.floor((e.clientY-t.top)/y)}},V=function(t){d=N(h,u),m=N(h,u,h*u+5);let o,y=new e(I);for(y.push({x:t.x,y:t.y,w:0});o=y.pop();)L(o)&&c[o.x][o.y]&&!d[o.x][o.y]&&(d[o.x][o.y]=1,m[o.x][o.y]=Math.min(m[o.x][o.y],o.w),y.push({x:o.x+1,y:o.y,w:o.w+1}),y.push({x:o.x-1,y:o.y,w:o.w+1}),y.push({x:o.x,y:o.y+1,w:o.w+1}),y.push({x:o.x,y:o.y-1,w:o.w+1}))},W=function(t){let o,y=new e(I),x=[],n=N(h,u);for(y.push({x:t.x,y:t.y,w:m[t.x][t.y]});(o=y.pop())&&(n[o.x][o.y]||(n[o.x][o.y]=1,y.push({x:o.x+1,y:o.y,w:m[o.x+1][o.y]}),y.push({x:o.x-1,y:o.y,w:m[o.x-1][o.y]}),y.push({x:o.x,y:o.y+1,w:m[o.x][o.y+1]}),y.push({x:o.x,y:o.y-1,w:m[o.x][o.y-1]}),x.push({x:o.x,y:o.y}),o.w)););return x},C=function(e,t){t=t||{};let o,x=Math.floor(y/2),r=t.path||W(e);for(n.lineWidth=t.width||Math.ceil(y/5),n.strokeStyle=t.color||"red",n.beginPath();o=r.pop();)n.lineTo(o.x*y+x,o.y*y+x);n.stroke()},H=function(e){let y=R(e);L(y)&&(y.x!==p||y.y!==w)&&c[y.x][y.y]&&(2===E.st&&clearInterval(t),M=W(y),t=setInterval(E.moveNode,o))},q=function(e){let t=R(e);g&&g.x===t.x&&g.y===t.y||(F({x:p,y:w}),L(t)&&(t.x!==p||t.y!==w)&&c[t.x][t.y]?(C(t),S(t,{color:"red",width:y-Math.floor(y/5)}),z=t):z=void 0,g=t)};return E.moveNode=function(){let e;if(!r)if(M&&(e=M.pop())){p=e.x,w=e.y,V({x:p,y:w}),F({x:p,y:w});let t=M.slice();t.push({x:p,y:w}),C(z,{path:t,color:"green",width:Math.ceil(y/5)+2}),!z||z.x===p&&z.y===w||(C(z),S(z,{color:"red",width:y-Math.floor(y/5)}))}else E.stop()},E.floodFillStep=function(){let e;r||(v&&(e=v.pop())?(function(e){let t={x:e.x,y:e.y};if(c[t.x][t.y]&&!d[t.x][t.y]){d[t.x][t.y]=1;let e,o=[];for(t.x-2>0&&o.push({x:t.x-2,y:t.y}),t.y-2>0&&o.push({x:t.x,y:t.y-2}),t.x+2<h-1&&o.push({x:t.x+2,y:t.y}),t.y+2<u-1&&o.push({x:t.x,y:t.y+2});e=o.shift();)v.filter(({x:t,y:o})=>t===e.x&&o===e.y).length<1&&v.push(e);if(c[t.x-1][t.y]+c[t.x][t.y-1]+c[t.x+1][t.y]+c[t.x][t.y+1]===1){let e,o=[];for(o.push({w:b(),x:t.x-2,y:t.y,fx:t.x-1,fy:t.y}),o.push({w:b(),x:t.x+2,y:t.y,fx:t.x+1,fy:t.y}),o.push({w:b(),x:t.x,y:t.y-2,fx:t.x,fy:t.y-1}),o.push({w:b(),x:t.x,y:t.y+2,fx:t.x,fy:t.y+1}),o.sort((e,t)=>e&&t&&e.w<t.w);e=o.shift();)if(e.x>0&&e.y>0&&e.x<h-1&&e.y<u-1&&!c[e.fx][e.fy]){c[e.fx][e.fy]=1,k.push({x:t.x,y:t.y,fx:e.fx,fy:e.fy});break}}}}(e),F(e)):(E.stop().st++,V({x:p,y:w}),F({x:p,y:w}),x.addEventListener("mousemove",q,!1),x.addEventListener("mousedown",H,!1)))},E.renderView=function(){let e;r||(a&&(e=a.pop())?(P(e),F(e)):(E.stop().st++,d=N(h,u),(v=[]).push({x:p,y:w}),t=setInterval(E.floodFillStep,o)))},E.start=function(){return x.width=window.innerWidth,x.height=window.innerHeight-40,y=f.value,h=Math.floor(x.width/y),u=Math.floor(x.height/y),o=i.value||1,r=!1,s.value="Pause",a=0===l.value?new function(){let e=[];return{get:t=>e[t]||e,empty:()=>!e.length,push:t=>e.push(t),pop:()=>e.shift()}}:1===l.value?new function(){let e=[];return{get:t=>e[t]||e,empty:()=>!e.length,push:t=>e.push(t),pop:()=>e.pop()}}:new e(I),p=2*Math.floor(Math.random()*(h-2)/2)+1,w=2*Math.floor(Math.random()*(u-2)/2)+1,c=N(h,u),k=[],E.st=0,x.removeEventListener("mousemove",q),x.removeEventListener("mousedown",H),P({x:p,y:w}),t=setInterval(E.renderView,o),E},E.stop=(()=>(clearInterval(t),E)),E.start(),E}),h.addEventListener("click",function(){maze.stop().start()}),window.onresize=function(){h.click()},s.addEventListener("click",function(){r=!r,s.value="Pause"===s.value?"Play":"Pause"}),i.addEventListener("change",function(){switch(o=this.value,maze.stop(),maze.st){case 0:t=setInterval(maze.renderView,o);break;case 1:t=setInterval(maze.floodFillStep,o);break;case 2:t=setInterval(maze.moveNode,o)}})}();